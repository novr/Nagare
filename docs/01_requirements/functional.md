# 01. 機能要件

## 1. ダッシュボード機能

### 1.1. Four Keys メトリクス表示

- 以下の4つの指標を時系列のトレンドグラフで表示する。
  - **デプロイ頻度 (Throughput):** `main`ブランチへのマージ回数などを集計。
  - **変更のリードタイム (Lead Time for Changes):** PR作成からマージまでの時間などを集計。
  - **変更障害率 (Change Failure Rate):** `main`ブランチでのマージビルドの失敗率。
  - **平均修復時間 (MTTR):** `main`ブランチでのビルド失敗から、次の成功までの平均時間。

### 1.2. フィルタリングとドリルダウン

- **フィルタリング:**
  - 表示するデータの期間を自由に指定できる。
  - プロジェクト単位、リポジトリ単位で表示を絞り込める。
- **ドリルダウン:**
  - ダッシュボード上のすべてのグラフや数値から、その根拠となる詳細データ（ビルド一覧、ジョブ一覧など）に掘り下げることができる。
  - 最終的には、CI/CDツール（GitHub Actionsなど）の元ログ画面へ直接遷移できるリンクを提供する。

### 1.3. プロジェクト管理機能

- 複数のリポジトリを「プロジェクト」という単位で論理的にグルーピングできる。
- ユーザーはプロジェクトを作成し、分析対象のリポジトリを自由に関連付けることができる。
- ダッシュボードはプロジェクト単位での指標表示に対応する。

### 1.4. ボトルネック分析支援

- **CI実行時間の分析:**
  - 指定期間内で、実行時間が長いビルドやジョブをランキング表示する。
- **ビルド成功率の分析:**
  - 指定期間内で、失敗回数が多いビルドやジョブをランキング表示する。

## 2. データ収集機能

### 2.1. データ収集の基本方針

- 指定されたリポジトリのCI/CD実行データを、連携ツール（GitHub Actionsなど）のAPIから自動で定期的に収集する。
- 収集したデータは、`02_design/data_model.md` に定義された汎用データモデルに変換してデータベースに保存する。

### 2.2. データ収集の制約と設計

- **GitHub API制約:**
  - GitHub Appsは1時間あたり15,000リクエストの制限がある。
  - この制約を考慮し、収集対象リポジトリ数と収集頻度を設計する必要がある。
  - 例: 100リポジトリを監視する場合、1リポジトリあたり1時間に150リクエストまで利用可能。

- **収集頻度:**
  - 初期実装では、1時間に1回程度の定期実行を想定。
  - API制約を超えないよう、Airflow DAGで適切なレート制限を実装する。

- **収集範囲:**
  - 新規データの増分収集を基本とする（全データの再取得は行わない）。
  - 初回セットアップ時は、過去30日分のデータを遡って収集する。
