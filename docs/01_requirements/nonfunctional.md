# 02. 非機能要件

## 1. セキュリティ (Security)

- **認証・認可:**
  - ユーザーはGitHubアカウントを利用して本システムにログイン（SSO）できる。
  - GitHub APIへのアクセスには、個人のアクセストークンではなく**GitHub Apps**を利用し、必要最小限の権限を付与する。
  - **MVP版の権限設計:**
    - 同じGitHub Organization（ORG）に所属するユーザーは、そのORG配下のすべてのプロジェクト・リポジトリのデータを閲覧可能。
    - リポジトリ単位やプロジェクト単位での細かい権限管理は、MVP対象外とする。
    - 将来的には、SupersetのRow Level Security機能を活用した権限管理を実装する可能性がある。
- **情報管理:**
  - データベース接続情報やAPIキーなどの秘匿情報は、コードリポジトリに含めず、AWS Secrets Managerなどの専用サービスで管理する。

## 2. 性能 (Performance) - MVP対象外

- **レスポンスタイム:**
  - ダッシュボードの主要な表示は、フィルタリング操作後3秒以内に完了すること。
  - Apache Supersetのキャッシュ機能を活用し、応答性を高める。

## 3. 可用性 (Availability) - MVP対象外

- 本番環境のSLAは99.5%を目指す。
- データ収集バッチの実行失敗を検知し、管理者に通知するアラート機構を設ける。

## 4. 保守性・拡張性 (Maintainability & Scalability)

- **データモデル:**
  - `02_design/data_model.md` に定義された汎用データモデルを採用し、将来的にGitHub Actions以外のCI/CDツール（GitLab CI, CircleCIなど）をデータソースとして追加可能にする。
- **コンポーネント分離:**
  - 「データ収集(Airflow)」「データベース(PostgreSQL)」「Webアプリ(Superset)」の3つのコンポーネントは独立してデプロイ・スケール可能であること。
- **コード品質:**
  - LinterとFormatterをCIで強制し、コードの可読性と保守性を維持する。

## 5. 運用 (Operation)

- **環境構築:**
  - ローカル開発環境は `docker-compose` コマンド一つで構築可能であること。
- **デプロイ:**
  - 本番環境へのデプロイは自動化されていること。
- **監視:**
  - 各コンポーネントのログは集約され、監視可能であること。

## 6. データ管理 (Data Management)

- **データ保持期間:**
  - 収集したCI/CD実行データは、**3年間**データベースに保持する。
  - 3年を超えた古いデータは、定期的にアーカイブまたは削除する。
  - データ削除は、`pipeline_runs`テーブルの`created_at`を基準として判定する。

- **データアーカイブ戦略:**
  - 初期実装では、古いデータの単純削除のみを実装する。
  - 将来的には、S3などのオブジェクトストレージへのアーカイブを検討する。

- **ストレージ見積もり:**
  - 100リポジトリ × 1日10ビルド × 365日 × 3年 ≒ 110万レコード程度を想定。
  - 適切なインデックス設計により、この規模でも十分なパフォーマンスを維持できる見込み。